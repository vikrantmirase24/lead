import{r as d,j as e,D as F,p as f,aC as w,c as v,R as I,q as u,aY as L,n as R,I as k,aH as S,a as P,e as C,H as B,C as z}from"./index-BtB7UOt2.js";import{C as H}from"./confirm-dialog-DGukidWh.js";import{C as N}from"./custom-breadcrumbs-DhW774YS.js";import{u as _,T as M,a as O,b as V,c as W,d as D,e as m,f as q,g as G,C as K}from"./table-pagination-custom-GsxC9MhW.js";import{C as U}from"./Card-DnppY8CG.js";import{T as Y}from"./TextField-DxmO3TN0.js";import{I as $}from"./InputAdornment-BvyjvqD-.js";import{C as J}from"./CircularProgress-Dtxp3OJV.js";import{a as Q}from"./Select-BfbTOkoI.js";import"./Dialog-DBgaWhmn.js";import"./KeyboardArrowRight-CNgXDUW1.js";import"./FormControlLabel-BSJAInse.js";import"./formControlState-Dq1zat_P.js";import"./isMuiElement-B37rc9mm.js";const j=[{id:"id",label:"ID"},{id:"name",label:"Document Name"},{id:"actions",label:"",width:88}];function X(){const o=_({defaultRowsPerPage:5}),[s,n]=d.useState(""),[r,c]=d.useState([]),[x,h]=d.useState(0),[E,p]=d.useState(!0),b=async(t=1,a=5)=>{p(!0);try{const i=await P.get(C.user.allPropertyDocument,{params:{page:t,page_size:a}}),l=i.data.results||[],g=i.data.count||0;c(l),h(g)}catch(i){console.error("Failed to fetch documents:",i),c([]),h(0)}finally{p(!1)}},y=async(t,a=1,i=5)=>{p(!0);try{const l=await P.get(C.user.searchPropertyDocument,{params:{search:t,page:a,page_size:i}}),g=l.data.results||[],A=l.data.count||0;c(g),h(A)}catch(l){console.error("Search failed:",l),c([]),h(0)}finally{p(!1)}};d.useEffect(()=>{const t=o.page+1,a=o.rowsPerPage;s.trim()?y(s,t,a):b(t,a)},[s,o.page,o.rowsPerPage]);const T=()=>{const t=o.page+1,a=o.rowsPerPage;s.trim()?y(s,t,a):b(t,a)};return e.jsxs(F,{children:[e.jsx(N,{heading:"Property Document List",links:[{name:"Dashboard",href:f.dashboard.root},{name:"Property Document"},{name:"List"}],action:e.jsx(w,{direction:"row",spacing:2,children:e.jsx(v,{sx:{mt:5},component:I,variant:"contained",href:f.dashboard.propetyDocumentadd,startIcon:e.jsx(u,{icon:"mingcute:add-line"}),children:"Add Document"})}),sx:{mb:{xs:3,md:3}}}),e.jsxs(U,{children:[e.jsx(w,{direction:"row",spacing:2,sx:{p:2},children:e.jsx(Y,{fullWidth:!0,placeholder:"Search by Document name",value:s,onChange:t=>n(t.target.value),onKeyDown:t=>{t.key==="Enter"&&T()},InputProps:{startAdornment:e.jsx($,{position:"start",children:e.jsx(u,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(L,{children:e.jsx(M,{sx:{minWidth:800},children:e.jsxs(O,{children:[e.jsx(V,{headLabel:j}),e.jsx(W,{children:E?e.jsx(D,{children:e.jsx(m,{colSpan:j.length,align:"center",children:e.jsx(J,{size:24})})}):r.length>0?r.map(t=>e.jsx(Z,{row:t,onDeleteSuccess:T},t.id)):e.jsx(D,{children:e.jsx(m,{colSpan:j.length,align:"center",children:"No data found"})})})]})})}),e.jsx(q,{page:o.page,count:x,rowsPerPage:o.rowsPerPage,onPageChange:o.onChangePage,onRowsPerPageChange:o.onChangeRowsPerPage})]})]})}function Z({row:o,onDeleteSuccess:s}){const n=G(),r=R(),c=async()=>{try{await P.delete(C.user.deletepropertydocument(o.id)),r.onFalse(),n.onClose(),s()}catch(x){console.error("Failed to delete document:",x)}};return e.jsxs(e.Fragment,{children:[e.jsxs(D,{hover:!0,children:[e.jsx(m,{children:o.id}),e.jsx(m,{children:o.name}),e.jsx(m,{align:"right",children:e.jsx(k,{onClick:n.onOpen,children:e.jsx(u,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(K,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,children:e.jsxs(Q,{children:[e.jsxs(S,{component:I,to:f.dashboard.propetyDocumentedit(o.id),children:[e.jsx(u,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(S,{onClick:r.onTrue,children:[e.jsx(u,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(H,{open:r.value,onClose:r.onFalse,title:"Delete Document",content:"Are you sure you want to delete this Property Document?",action:e.jsx(v,{variant:"contained",color:"error",onClick:c,children:"Delete"})})]})}const ee={title:`User View | Dashboard - ${z.appName}`};function xe(){return e.jsxs(e.Fragment,{children:[e.jsx(B,{children:e.jsxs("title",{children:[" ",ee.title]})}),e.jsx(X,{})]})}export{xe as default};
