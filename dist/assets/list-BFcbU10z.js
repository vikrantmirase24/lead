import{r as p,j as e,D as I,p as P,aC as g,c as w,R as T,q as c,aY as L,n as E,I as S,aH as C,a as j,e as y,H as F,C as R}from"./index-BtB7UOt2.js";import{C as k}from"./confirm-dialog-DGukidWh.js";import{C as B}from"./custom-breadcrumbs-DhW774YS.js";import{u as H,T as N,a as M,b as O,c as V,d as A,e as h,f as W,g as _,C as q}from"./table-pagination-custom-GsxC9MhW.js";import{C as z}from"./Card-DnppY8CG.js";import{T as G}from"./TextField-DxmO3TN0.js";import{I as K}from"./InputAdornment-BvyjvqD-.js";import{C as U}from"./CircularProgress-Dtxp3OJV.js";import{a as Y}from"./Select-BfbTOkoI.js";import"./Dialog-DBgaWhmn.js";import"./KeyboardArrowRight-CNgXDUW1.js";import"./FormControlLabel-BSJAInse.js";import"./formControlState-Dq1zat_P.js";import"./isMuiElement-B37rc9mm.js";const b=[{id:"id",label:"ID"},{id:"name",label:"Property Name"},{id:"actions",label:"",width:88}];function $(){const r=H({defaultRowsPerPage:5}),[s,t]=p.useState(""),[o,n]=p.useState([]),[m,d]=p.useState(!0),x=async()=>{d(!0);try{const a=await j.get(y.user.allProperty),i=Array.isArray(a.data)?a.data:a.data.results||a.data.data||[];n(i)}catch(a){console.error("Error fetching property list:",a),n([])}finally{d(!1)}},f=async(a,i=1,D=r.rowsPerPage)=>{d(!0);try{const l=await j.get(y.user.searchProperty,{params:{search:a,page:i,page_size:D}}),v=Array.isArray(l.data)?l.data:l.data.results||l.data.data||[];n(v)}catch(l){console.error("Search failed:",l),n([])}finally{d(!1)}};p.useEffect(()=>{s.trim()?f(s,r.page+1,r.rowsPerPage):x()},[s,r.page,r.rowsPerPage]);const u=Array.isArray(o)?o.filter(a=>{var i;return(i=a.name)==null?void 0:i.toLowerCase().includes(s.toLowerCase())}):[];return e.jsxs(I,{children:[e.jsx(B,{heading:"Property List",links:[{name:"Dashboard",href:P.dashboard.root},{name:"Property"},{name:"List"}],action:e.jsx(g,{direction:"row",spacing:2,children:e.jsx(w,{sx:{mt:5},component:T,variant:"contained",href:P.dashboard.propertyadd,startIcon:e.jsx(c,{icon:"mingcute:add-line"}),children:"Add Property"})}),sx:{mb:{xs:3,md:3}}}),e.jsxs(z,{children:[e.jsx(g,{direction:"row",spacing:2,sx:{p:2},children:e.jsx(G,{fullWidth:!0,placeholder:"Search by Property name",value:s,onChange:a=>t(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(s.trim()?f(s,r.page+1,r.rowsPerPage):x())},InputProps:{startAdornment:e.jsx(K,{position:"start",children:e.jsx(c,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),m?e.jsx(g,{alignItems:"center",py:5,children:e.jsx(U,{})}):e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsx(N,{sx:{minWidth:800},children:e.jsxs(M,{children:[e.jsx(O,{headLabel:b}),e.jsx(V,{children:u.length>0?u.slice(r.page*r.rowsPerPage,(r.page+1)*r.rowsPerPage).map(a=>e.jsx(J,{row:a,onDelete:x},a.id)):e.jsx(A,{children:e.jsx(h,{colSpan:b.length,align:"center",children:"No data found"})})})]})})}),e.jsx(W,{page:r.page,count:u.length,rowsPerPage:r.rowsPerPage,onPageChange:r.onChangePage,onRowsPerPageChange:r.onChangeRowsPerPage})]})]})]})}function J({row:r,onDelete:s}){const t=_(),o=E(),n=async()=>{try{await j.delete(y.user.deleteProperty(r.id)),o.onFalse(),t.onClose(),s()}catch(m){console.error("Failed to delete property:",m)}};return e.jsxs(e.Fragment,{children:[e.jsxs(A,{hover:!0,children:[e.jsx(h,{children:r.id}),e.jsx(h,{children:r.name}),e.jsx(h,{align:"right",children:e.jsx(S,{onClick:t.onOpen,children:e.jsx(c,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(q,{open:t.open,anchorEl:t.anchorEl,onClose:t.onClose,children:e.jsxs(Y,{children:[e.jsxs(C,{component:T,to:P.dashboard.propertyedit(r.id),children:[e.jsx(c,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(C,{onClick:o.onTrue,children:[e.jsx(c,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(k,{open:o.value,onClose:o.onFalse,title:"Delete Property",content:"Are you sure you want to delete this Property?",action:e.jsx(w,{variant:"contained",color:"error",onClick:n,children:"Delete"})})]})}const Q={title:`User View | Dashboard - ${R.appName}`};function he(){return e.jsxs(e.Fragment,{children:[e.jsx(F,{children:e.jsxs("title",{children:[" ",Q.title]})}),e.jsx($,{})]})}export{he as default};
