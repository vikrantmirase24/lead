import{aZ as E,r as i,j as t,D as B,p as k,A as S,aC as h,T as n,B as F,c as v,aH as d,a as T,e as C,H as U,C as _}from"./index-BtB7UOt2.js";import{C as M}from"./custom-breadcrumbs-DhW774YS.js";import{C as N}from"./CircularProgress-Dtxp3OJV.js";import{C as D}from"./Card-DnppY8CG.js";import{G as o}from"./Grid-BCj60A8z.js";import{F as P,S as V}from"./Select-BfbTOkoI.js";import"./isMuiElement-B37rc9mm.js";import"./formControlState-Dq1zat_P.js";function R(){const{id:l}=E(),[e,x]=i.useState(null),[A,m]=i.useState(!1),[a,p]=i.useState(""),[u,j]=i.useState(!1),[f,g]=i.useState(""),[y,b]=i.useState(""),I="https://lead.berarfinance.com/leadapi/media/";i.useEffect(()=>{if(!l)return;(async()=>{try{m(!0);const r=await T.get(C.user.Ticketgetbyid(l));console.log("Ticket Detail:",r.data.data),x(r.data.data),p(r.data.data.status)}catch(r){console.error("Error fetching Ticket details:",r)}finally{m(!1)}})()},[l]);const w=async()=>{try{j(!0),await T.patch(C.user.Ticketgetbyid(l),{status:a}),x(s=>({...s,status:a,status_display:a===1?"Open":a===2?"Closed":a===3?"Working/Active":a===4?"Reject":s.status_display})),b("Status Updtated Successfully!"),setTimeout(()=>b(""),3e3)}catch(s){console.error("Error updating status:",s),g("Status Updtation Failed!"),setTimeout(()=>g(""),3e3)}finally{j(!1)}},c=(s,r)=>t.jsxs(o,{item:!0,xs:12,md:6,children:[t.jsx(n,{variant:"subtitle2",color:"text.secondary",children:s}),t.jsx(n,{variant:"body1",children:r||"NA"})]});return t.jsxs(B,{children:[t.jsx(M,{heading:"Ticket Details",links:[{name:"Dashboard",href:k.dashboard.root},{name:"Tickets",href:k.dashboard.activeTickets},{name:"View"}],sx:{mb:{xs:3,md:3}}}),y&&t.jsx(S,{severity:"success",sx:{mb:3},children:y}),f&&t.jsx(S,{severity:"error",sx:{mb:3},children:f}),A?t.jsx(h,{alignItems:"center",justifyContent:"center",sx:{py:5},children:t.jsx(N,{})}):e?t.jsx(h,{spacing:3,children:t.jsxs(D,{sx:{p:3},children:[t.jsx(n,{variant:"h6",gutterBottom:!0,children:"Ticket Information"}),t.jsxs(o,{container:!0,spacing:2,children:[c("Ticket ID",e.id),c("Title",e.title),c("Description",e.description),t.jsxs(o,{item:!0,xs:12,md:6,children:[t.jsx(n,{variant:"subtitle2",color:"text.secondary",children:"Attachment"}),e.attachment?t.jsx(F,{children:t.jsx(v,{variant:"outlined",size:"small",component:"a",href:e.attachment.startsWith("http")?e.attachment:`${I}${e.attachment}`,target:"_blank",rel:"noopener noreferrer",children:"View"})}):t.jsx(n,{variant:"body1",children:"No Attachment"})]}),t.jsxs(o,{item:!0,xs:12,md:6,children:[t.jsx(n,{variant:"subtitle2",color:"text.secondary",children:"Status"}),t.jsx(P,{fullWidth:!0,size:"small",children:t.jsxs(V,{labelId:"status-label",value:a,onChange:s=>p(s.target.value),disabled:u,children:[t.jsx(d,{value:1,children:"Open"}),t.jsx(d,{value:2,children:"Closed"}),t.jsx(d,{value:3,children:"Working/Active"}),t.jsx(d,{value:4,children:"Reject"})]})})]}),c("Status (Display)",e.status_display),c("Priority",e.priority_display),t.jsx(o,{item:!0,xs:12,children:t.jsx(h,{direction:"row",justifyContent:"flex-end",children:t.jsx(v,{variant:"contained",onClick:w,disabled:u,children:u?"Updating...":"Submit"})})})]})]})}):t.jsx(D,{sx:{p:3,textAlign:"center"},children:t.jsx(n,{variant:"h6",children:"No data found"})})]})}const W={title:`User View | Dashboard - ${_.appName}`};function J(){return t.jsxs(t.Fragment,{children:[t.jsx(U,{children:t.jsxs("title",{children:[" ",W.title]})}),t.jsx(R,{})]})}export{J as default};
