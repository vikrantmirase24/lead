import{r as h,j as e,D as v,p as j,aC as y,c as w,R as T,q as c,aY as E,n as I,I as S,aH as B,a as f,e as b,H as L,C as N}from"./index-BtB7UOt2.js";import{C as R}from"./confirm-dialog-DGukidWh.js";import{C as k}from"./custom-breadcrumbs-DhW774YS.js";import{u as F,T as H,a as z,b as M,c as O,d as C,e as d,f as V,g as W,C as _}from"./table-pagination-custom-GsxC9MhW.js";import{C as q}from"./Card-DnppY8CG.js";import{T as G}from"./TextField-DxmO3TN0.js";import{I as K}from"./InputAdornment-BvyjvqD-.js";import{C as U}from"./CircularProgress-Dtxp3OJV.js";import{a as Y}from"./Select-BfbTOkoI.js";import"./Dialog-DBgaWhmn.js";import"./KeyboardArrowRight-CNgXDUW1.js";import"./FormControlLabel-BSJAInse.js";import"./formControlState-Dq1zat_P.js";import"./isMuiElement-B37rc9mm.js";const g=[{id:"id",label:"ID"},{id:"name",label:"Business Name"},{id:"actions",label:"",width:88}];function $(){const s=F({defaultRowsPerPage:5}),[r,n]=h.useState(""),[t,o]=h.useState([]),[m,u]=h.useState(!0),x=async()=>{u(!0);try{const a=await f.get(b.user.allNatureBusiness),i=Array.isArray(a.data)?a.data:a.data.data||[];o(i)}catch(a){console.error("Error fetching businesses:",a),o([])}finally{u(!1)}},P=async(a,i=1,A=5)=>{u(!0);try{const l=await f.get(b.user.searchNatureBusiness,{params:{search:a,page:i,page_size:A}}),D=Array.isArray(l.data)?l.data:l.data.results||l.data.data||[];o(D)}catch(l){console.error("Search failed:",l),o([])}finally{u(!1)}};h.useEffect(()=>{r.trim()?P(r,s.page+1,s.rowsPerPage):x()},[r,s.page,s.rowsPerPage]);const p=Array.isArray(t)?t.filter(a=>{var i;return(i=a.name)==null?void 0:i.toLowerCase().includes(r.toLowerCase())}):[];return e.jsxs(v,{children:[e.jsx(k,{heading:"Business List",links:[{name:"Dashboard",href:j.dashboard.root},{name:"Business"},{name:"List"}],action:e.jsx(y,{direction:"row",spacing:2,children:e.jsx(w,{sx:{mt:5},component:T,variant:"contained",href:j.dashboard.natureBusinessadd,startIcon:e.jsx(c,{icon:"mingcute:add-line"}),children:"Add Business"})}),sx:{mb:{xs:3,md:3}}}),e.jsxs(q,{children:[e.jsx(y,{direction:"row",spacing:2,sx:{p:2},children:e.jsx(G,{fullWidth:!0,placeholder:"Search by Business name",value:r,onChange:a=>n(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(r.trim()?P(r,s.page+1,s.rowsPerPage):x())},InputProps:{startAdornment:e.jsx(K,{position:"start",children:e.jsx(c,{icon:"eva:search-fill",sx:{color:"text.disabled"}})})}})}),e.jsx(E,{children:e.jsx(H,{sx:{minWidth:800},children:e.jsxs(z,{children:[e.jsx(M,{headLabel:g}),e.jsx(O,{children:m?e.jsx(C,{children:e.jsx(d,{colSpan:g.length,align:"center",children:e.jsx(U,{size:24})})}):p.length>0?p.slice(s.page*s.rowsPerPage,(s.page+1)*s.rowsPerPage).map(a=>e.jsx(J,{row:a,onDeleteSuccess:x},a.id)):e.jsx(C,{children:e.jsx(d,{colSpan:g.length,align:"center",children:"No data found"})})})]})})}),e.jsx(V,{page:s.page,count:p.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,onRowsPerPageChange:s.onChangeRowsPerPage})]})]})}function J({row:s,onDeleteSuccess:r}){const n=W(),t=I(),o=async()=>{try{await f.delete(b.user.deleteNatureBusiness(s.id)),t.onFalse(),n.onClose(),r()}catch(m){console.error("Error deleting business:",m)}};return e.jsxs(e.Fragment,{children:[e.jsxs(C,{hover:!0,children:[e.jsx(d,{children:s.id}),e.jsx(d,{children:s.name}),e.jsx(d,{align:"right",children:e.jsx(S,{onClick:n.onOpen,children:e.jsx(c,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(_,{open:n.open,anchorEl:n.anchorEl,onClose:n.onClose,children:e.jsxs(Y,{children:[e.jsxs(B,{component:T,to:j.dashboard.natureBusinessedit(s.id),children:[e.jsx(c,{icon:"solar:pen-bold"}),"Edit"]}),e.jsxs(B,{onClick:t.onTrue,children:[e.jsx(c,{icon:"solar:trash-bin-trash-bold"}),"Delete"]})]})}),e.jsx(R,{open:t.value,onClose:t.onFalse,title:"Delete Business",content:"Are you sure you want to delete this Business?",action:e.jsx(w,{variant:"contained",color:"error",onClick:o,children:"Delete"})})]})}const Q={title:`User View | Dashboard - ${N.appName}`};function he(){return e.jsxs(e.Fragment,{children:[e.jsx(L,{children:e.jsxs("title",{children:[" ",Q.title]})}),e.jsx($,{})]})}export{he as default};
